<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Horse Wash - Application</title>
<link rel="manifest" href="manifest.json">
<style>
body { margin:0; padding:0; font-family:Arial,sans-serif; background:#f5f5f5; color:#000; }
header { display:flex; align-items:center; justify-content:center; /* brighter bluer branding */ background: linear-gradient(90deg,#2b8fe6 0%, #66b3ff 100%); padding:12px 20px; position:relative; }
header img { height:84px; width:auto; }
.cart-summary { position:absolute; right:16px; top:16px; color:#06314d; cursor:pointer; font-weight:700; background: rgba(255,255,255,0.92); padding:6px 10px; border-radius:10px; box-shadow:0 6px 14px rgba(3,34,56,0.12); }

main { padding:20px; margin-bottom:70px; }
section { display:none; padding:20px; background:#fff; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
section.active { display:block; }
h1,h2 { margin-bottom:15px; text-align:center; }

.products-grid, .services-grid, .abonnement-grid { 
  display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:15px; 
}
.product-item, .service-item, .abonnement-item { 
  text-align:center; border-radius:12px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); background:#fff; 
}
.product-item img, .service-item img {
  width:100%; display:block; aspect-ratio:4/3; object-fit:cover; object-position:center center; border-radius:8px; max-height:160px;
}
.abonnement-item img {
  width:100%; display:block; aspect-ratio:3/2; object-fit:cover; object-position:center center; border-radius:8px; max-height:120px;
}

.profile-grid { display:grid; grid-template-columns:1fr 1fr; gap:15px; }
.profile-grid input { width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; }

.progress-container { background:#eee; border-radius:12px; overflow:hidden; margin-top:10px; }
.progress-bar { height:20px; width:0%; background:#000; text-align:center; color:#fff; line-height:20px; }

.photo-comparison { display:flex; flex-direction:row; gap:10px; margin-top:10px; }
.photo-comparison img { width:48%; height:auto; border-radius:8px; }

/* Bottom navigation - redesigned */
.bottom-nav { position:fixed; left:50%; transform:translateX(-50%); bottom:18px; background:linear-gradient(90deg,#0f4c81 0%, #1e90ff 100%); padding:8px 14px; border-radius:40px; display:flex; gap:18px; align-items:center; box-shadow:0 8px 20px rgba(11,97,166,0.18); z-index:110; }
.bottom-nav .nav-item { color:#fff; text-decoration:none; text-align:center; font-size:12px; display:flex; flex-direction:column; align-items:center; gap:6px; width:56px; padding:6px 4px; border-radius:12px; transition:transform .18s ease, background .18s ease; }
.bottom-nav .nav-item img { width:28px; height:28px; border-radius:6px; object-fit:cover; }
.bottom-nav .nav-item.active { background:rgba(212,175,55,0.12); transform:translateY(-4px) scale(1.03); box-shadow:0 8px 18px rgba(11,97,166,0.22); }
.bottom-nav .nav-item .label { font-size:11px; line-height:1; }

/* Floating FAB-style "Plus" button */
.fab-more { width:44px; height:44px; border-radius:50%; background:#1e90ff; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:700; box-shadow:0 8px 16px rgba(0,0,0,0.12); cursor:pointer; }

/* Modal/panel for additional links */
.more-modal { position:fixed; left:50%; transform:translateX(-50%) translateY(10px) scale(.98); bottom:86px; width:92%; max-width:420px; background:#fff; border-radius:12px; padding:12px; box-shadow:0 14px 40px rgba(0,0,0,0.28); z-index:120; opacity:0; visibility:hidden; transition:transform .26s cubic-bezier(.22,.9,.26,1), opacity .22s ease; transform-origin:50% 100%; }
.more-modal.open { opacity:1; visibility:visible; transform:translateX(-50%) translateY(0) scale(1); }
.more-modal h3 { margin:0 0 8px 0; }
.more-modal .more-list { display:flex; gap:10px; flex-wrap:wrap; }
.more-modal .more-list a { flex:1 1 45%; background:#f7f7f7; padding:10px; border-radius:8px; text-align:center; text-decoration:none; color:#111; transition:background .12s ease, transform .12s ease; }
.more-modal .more-list a:active { transform:translateY(1px); }

/* Product/service card hover / interactions for a more dynamic feel */
.product-item, .service-item {
  transition: transform .18s ease, box-shadow .18s ease;
}
.product-item:hover, .service-item:hover {
  transform: translateY(-6px) scale(1.02);
  box-shadow:0 10px 24px rgba(0,0,0,0.14);
}

.product-item button {
  background:#1e90ff; border:none; color:#fff; padding:8px 12px; border-radius:8px; cursor:pointer; transition:transform .12s ease, box-shadow .12s ease;
}
.product-item button:hover { transform:translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.12); }

/* small 'pop' animation when adding to cart */
@keyframes pop {
  0% { transform: scale(1); }
  40% { transform: scale(1.12); }
  100% { transform: scale(1); }
}
.product-item button.anim-pop { animation: pop .36s ease; }

/* FAB pulse when opening modal for a lively feel */
.fab-more.opening { animation: pulse 0.8s ease; }
@keyframes pulse { 0% { transform:scale(1); } 50% { transform:scale(1.08);} 100% { transform:scale(1);} }

/* allow svg sizing in nav */
.bottom-nav .nav-item svg { width:28px; height:28px; display:block; }
.bottom-nav .nav-item { color:#fff; }
.bottom-nav .nav-item.active svg { fill:#66b3ff; }

@media(max-width:480px){
  .bottom-nav { width:calc(100% - 36px); left:18px; transform:none; border-radius:12px; }
}

#home img { width:100%; max-width:350px; height:auto; display:block; margin:0 auto; border-radius:12px; }

/* Titre principal */
#home h1 {
  font-family: 'Cinzel', serif;
  font-size: 3rem;
  color: #0b61a6; /* deep blue for a fresher look */
  text-align: center;
  letter-spacing: 3px;
  font-weight: 700;
  text-transform: uppercase;
  margin-top: 30px;
  margin-bottom: 50px;
  position: relative;
  display: block;
  z-index: 10;
  -webkit-text-stroke: 1.2px rgba(8,30,60,0.9);
  text-shadow: 0 6px 14px rgba(11,97,166,0.12);
}
#home h1::after {
  content: "";
  display: block;
  width: 80px;
  height: 4px;
  background-color: #1e90ff;
  margin: 10px auto 0;
  border-radius: 2px;
}

/* Cart modal */
.cart-modal { position:fixed; right:16px; top:64px; width:320px; max-width:90vw; background:#fff; border-radius:12px; box-shadow:0 18px 40px rgba(3,34,56,0.18); z-index:130; padding:12px; display:none; }
.cart-modal.open { display:block; }
.cart-modal h4 { margin:0 0 8px 0; }
.cart-modal .cart-items { max-height:260px; overflow:auto; margin-bottom:8px; }
.cart-modal .cart-items li { display:flex; justify-content:space-between; padding:8px 6px; border-bottom:1px solid #f1f1f1; }
.cart-modal .cart-footer { display:flex; justify-content:space-between; align-items:center; }
.cart-modal button { background:#1e90ff; color:#fff; border:none; padding:8px 10px; border-radius:8px; cursor:pointer; }

@media(max-width:768px){ 
  .profile-grid { grid-template-columns:1fr; } 
  .photo-comparison { flex-direction:column; } 
}
@media(max-width:480px){
  .services-grid img, .products-grid img { height:140px; }
  .abonnement-grid img { height:100px; }
}
</style>
</head>
<body>

<header>
  <img src="image/logo.jpg" alt="Logo Black Horse Wash">
  <div class="cart-summary" onclick="showCart()" role="button" aria-label="Ouvrir le panier">Panier: <span id="cart-count">0</span></div>
</header>

<main>
  <!-- ACCUEIL -->
  <section id="home" class="active">
    <h1>Black Horse Wash</h1>
    <img src="image/CarWash.jpg" alt="Car Wash">
  </section>

  <!-- PROFIL -->
  <section id="profil">
    <h2>Profil Client</h2>
    <div class="profile-grid">
      <div><label>Nom</label><input type="text" placeholder="Nom du client"></div>
      <div><label>Véhicule</label><input type="text" placeholder="Modèle du véhicule"></div>
      <div><label>Adresse</label><input type="text" placeholder="Adresse"></div>
      <div><label>Prochain RDV</label><input type="datetime-local"></div>
      <div style="grid-column:1/-1;">
        <h3>Abonnements actifs</h3>
        <ul id="subscriptions-list" style="margin:8px 0 0 0;padding-left:18px;"></ul>
      </div>
      <div><label>Points fidélité</label>
        <div class="progress-container"><div class="progress-bar" style="width:40%;">40 pts</div></div>
      </div>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services">
    <h2>Services</h2>
      <div class="services-grid">
        <div class="service-item"><img src="image/interieur-voiture.jpg" alt="Intérieur Voiture" loading="lazy"><h3>Intérieur Voiture</h3><p>20€</p></div>
        <div class="service-item"><img src="image/exterieur-voiture.jpg" alt="Extérieur Voiture" loading="lazy"><h3>Extérieur Voiture</h3><p>15€</p></div>
        <div class="service-item"><img src="image/lavage-les-2.jpg" alt="Nettoyage Complet" loading="lazy"><h3>Nettoyage Complet</h3><p>30€</p></div>
      </div>
  </section>

  <!-- PRODUITS -->
  <section id="products">
    <h2>Produits à la vente</h2>
      <div class="products-grid">
    <div class="product-item"><img src="image/shampoo-car.jpg" alt="Shampooing" loading="lazy"><h3>Shampooing</h3><p>10 €</p><button data-price="10" onclick="addToCart(this,'Shampooing')">Ajouter au panier</button></div>
    <div class="product-item"><img src="image/lustrant-voiture.jpg" alt="Lustrant" loading="lazy"><h3>Lustrant</h3><p>15 €</p><button data-price="15" onclick="addToCart(this,'Lustrant')">Ajouter au panier</button></div>
    <div class="product-item"><img src="image/micro-fibre.jpg" alt="Microfibre" loading="lazy"><h3>Microfibre</h3><p>5 €</p><button data-price="5" onclick="addToCart(this,'Microfibre')">Ajouter au panier</button></div>
      </div>
  </section>

  <!-- RDV -->
  <section id="rdv">
    <h2>Demande de RDV</h2>
    <label>Client</label><input type="text">
    <label>Véhicule</label><input type="text">
    <label>Service demandé</label>
    <select>
      <option>Intérieur Voiture</option>
      <option>Extérieur Voiture</option>
      <option>Nettoyage Complet</option>
      <option>Options (Siège bébé, poils animaux)</option>
    </select>
    <label>Paiement</label>
    <select>
      <option>Carte bancaire</option>
      <option>Espèces</option>
      <option>PayPal</option>
    </select>
    <button>Réserver</button>
  </section>

  <!-- AVANCÉ -->
  <section id="avance">
    <h2>Avancement du RDV</h2>
    <div class="progress-container"><div class="progress-bar" style="width:50%;">50%</div></div>
    <h3>Photos Avant / Après</h3>
    <div class="photo-comparison">
      <div><p>Avant</p><img src="image/shampoo-car.jpg" alt="Avant"></div>
      <div><p>Après</p><img src="image/lustrant-voiture.jpg" alt="Après"></div>
    </div>
    <p>Nom du professionnel : Jean Dupont</p>
  </section>

  <!-- MAPS -->
  <section id="maps">
    <h2>Maps</h2>
    <iframe src="https://maps.google.com/maps?q=Paris&t=&z=13&ie=UTF8&iwloc=&output=embed" style="width:100%;height:300px;border:0;border-radius:12px;"></iframe>
  </section>

  <!-- ABONNEMENTS -->
  <section id="abonnements">
    <h2>Abonnements</h2>
    <div class="abonnement-grid">
      <div class="abonnement-item"><img src="image/abonnement-basic.jpg" alt="Basic"><p>Basic - 10€</p><button data-price="10" onclick="addSubscription(this,'Basic',10)">S'abonner</button></div>
      <div class="abonnement-item"><img src="image/abonnement-medium.jpg" alt="Medium"><p>Medium - 20€</p><button data-price="20" onclick="addSubscription(this,'Medium',20)">S'abonner</button></div>
      <div class="abonnement-item"><img src="image/abonnement-premium.jpg" alt="Premium"><p>Premium - 30€</p><button data-price="30" onclick="addSubscription(this,'Premium',30)">S'abonner</button></div>
    </div>
  </section>
</main>

<!-- NAVIGATION (redesign) -->
<nav class="bottom-nav" role="navigation" aria-label="Navigation principale">
  <a href="#" class="nav-item" data-target="home" onclick="showSection('home');return false;" aria-label="Accueil">
    <!-- Home SVG -->
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M12 3l9 7v8a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10l9-7z"></path></svg>
    <span class="label">Accueil</span>
  </a>
  <a href="#" class="nav-item" data-target="services" onclick="showSection('services');return false;" aria-label="Services">
    <!-- Car wash themed SVG icon -->
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
      <path fill="currentColor" d="M5 16c-.6 0-1-.4-1-1V10c0-1.1.9-2 2-2h1V6c0-.6.4-1 1-1h1c.6 0 1 .4 1 1v2h2V6c0-.6.4-1 1-1h1c.6 0 1 .4 1 1v2h1c1.1 0 2 .9 2 2v5c0 .6-.4 1-1 1h-1v1c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1v-1H5zm2-4a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm8 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM7 9h10v1H7V9zm11.5-4.5c-.3.3-.8.3-1.1 0-.3-.3-.3-.8 0-1.1.3-.3.8-.3 1.1 0 .3.3.3.8 0 1.1zm-3 0c-.3.3-.8.3-1.1 0-.3-.3-.3-.8 0-1.1.3-.3.8-.3 1.1 0 .3.3.3.8 0 1.1z"/>
    </svg>
    <span class="label">Services</span>
  </a>
  <a href="#" class="nav-item" data-target="products" onclick="showSection('products');return false;" aria-label="Produits">
    <!-- Bag / Products SVG -->
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path fill="currentColor" d="M6 2h12l1.6 4H4.4L6 2zM5 8h14v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8zm6 2a3 3 0 0 1 3 3h-2a1 1 0 1 0-2 0H8a3 3 0 0 1 3-3z"></path></svg>
    <span class="label">Produits</span>
  </a>
  <a href="#" class="nav-item" data-target="rdv" onclick="showSection('rdv');return false;" aria-label="Réserver">
    <!-- Calendar / RDV SVG -->
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path fill="currentColor" d="M7 10h10v6H7v-6zm8-6h2v2h-2V4zM9 4h2v2H9V4zM3 8h18v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8z"></path></svg>
    <span class="label">RDV</span>
  </a>
  <a href="#" class="nav-item" data-target="profil" onclick="showSection('profil');return false;" aria-label="Profil">
    <!-- User / Profile SVG -->
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path fill="currentColor" d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4zm0 2c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4z"></path></svg>
    <span class="label">Profil</span>
  </a>
  <div class="fab-more" role="button" aria-label="Plus" onclick="toggleMore();">+</div>
</nav>

<!-- More modal: regroupe les sections moins utilisées -->
<div id="more-modal" class="more-modal" aria-hidden="true">
  <h3>Plus</h3>
  <div class="more-list">
    <a href="#" onclick="showSection('avance');toggleMore();return false;">Avancement</a>
    <a href="#" onclick="showSection('maps');toggleMore();return false;">Maps</a>
    <a href="#" onclick="showSection('abonnements');toggleMore();return false;">Abonnements</a>
    <a href="#" onclick="document.getElementById('more-modal').classList.remove('open');document.getElementById('more-modal').setAttribute('aria-hidden','true');return false;">Fermer</a>
  </div>
</div>

<!-- Cart modal -->
<div id="cart-modal" class="cart-modal" aria-hidden="true">
  <h4>Panier</h4>
  <ul class="cart-items" id="cart-items-list"></ul>
  <div class="cart-footer">
    <div id="cart-total">Total: 0 €</div>
    <div>
      <button onclick="checkout()">Payer</button>
    </div>
  </div>
</div>

<footer>© 2025 Black Horse Wash</footer>

<script>
let cartCount = 0;
let cart = JSON.parse(localStorage.getItem('bhw_cart') || '[]');
let subscriptions = JSON.parse(localStorage.getItem('bhw_subscriptions') || '[]');
// initialize cartCount from stored cart
cartCount = cart.reduce((s,i)=>s + (i.qty||1), 0);
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('cart-count').textContent = cartCount;
  renderCart();
  renderSubscriptions();
});
function addToCart(buttonOrName, productName, priceParam, typeParam){
  // Support calling addToCart(this, 'Name') or addToCart('Name') for backwards compatibility
  let btn = null;
  let name = productName;
  if (typeof buttonOrName === 'object' && buttonOrName !== null && buttonOrName.tagName){
    btn = buttonOrName;
  } else {
    name = buttonOrName;
  }

  // determine price and type
  const nameKey = name || productName;
  let price = 0;
  if (priceParam !== undefined) price = Number(priceParam) || 0;
  else if (btn && btn.dataset && btn.dataset.price) price = Number(btn.dataset.price) || 0;
  const type = typeParam || (btn && btn.dataset && btn.dataset.type) || 'product';

  // update cart data structure and persist
  const existing = cart.find(i=>i.name === nameKey && i.type === type);
  if (existing) existing.qty = (existing.qty||1)+1;
  else cart.push({ name: nameKey, qty: 1, price: price, type: type });
  try { localStorage.setItem('bhw_cart', JSON.stringify(cart)); } catch(e){ console.warn('LocalStorage error', e); }
  cartCount = cart.reduce((s,i)=>s + (i.qty||1), 0);
  document.getElementById('cart-count').textContent = cartCount;

  // animate button if provided
  if (btn) {
    btn.classList.add('anim-pop');
    setTimeout(() => btn.classList.remove('anim-pop'), 400);
  }

  // Friendly toast instead of alert
  showToast((name || productName) + " ajouté au panier !");
  renderCart();
}

function renderCart(){
  const list = document.getElementById('cart-items-list');
  const totalEl = document.getElementById('cart-total');
  if(!list) return;
  list.innerHTML = '';
  let total = 0;
  if(cart.length === 0){
    const li = document.createElement('li'); li.textContent = 'Panier vide'; list.appendChild(li); total = 0;
  } else {
    cart.forEach((item, idx)=>{
      const li = document.createElement('li');
      const priceText = item.price ? (item.price * (item.qty||1)).toFixed(2) + ' €' : '';
      li.innerHTML = `<span>${item.name} <small style="color:#666">x${item.qty||1}${item.type==='subscription'?' • abonnement':''}</small></span><span>${priceText} <button onclick="removeCartItem(${idx})" style="margin-left:8px;background:transparent;border:none;color:#d00;cursor:pointer">Suppr</button></span>`;
      list.appendChild(li);
      total += (item.price||0) * (item.qty||1);
    });
  }
  totalEl.textContent = `Total: ${total.toFixed(2)} €`;
}

function removeCartItem(index){
  if(index < 0 || index >= cart.length) return;
  cart.splice(index,1);
  try{ localStorage.setItem('bhw_cart', JSON.stringify(cart)); } catch(e){}
  cartCount = cart.reduce((s,i)=>s + (i.qty||1), 0);
  document.getElementById('cart-count').textContent = cartCount;
  renderCart();
}

function showCart(){
  const modal = document.getElementById('cart-modal');
  if(!modal) return;
  const opened = modal.classList.toggle('open');
  modal.setAttribute('aria-hidden', opened ? 'false' : 'true');
  if(opened) renderCart();
}

function checkout(){
  // Simulated checkout: process subscriptions into profile, then clear cart
  if(cart.length === 0){ showToast('Le panier est vide'); return; }
  // Move subscription items to subscriptions list
  const subsToAdd = cart.filter(i=>i.type === 'subscription');
  if(subsToAdd.length){
    subsToAdd.forEach(s => subscriptions.push({ name: s.name, price: s.price || 0, date: new Date().toISOString() }));
    try{ localStorage.setItem('bhw_subscriptions', JSON.stringify(subscriptions)); } catch(e){}
  }
  // In a real flow you'd create an order and charge the user here
  cart = [];
  try{ localStorage.setItem('bhw_cart', JSON.stringify(cart)); } catch(e){}
  cartCount = 0; document.getElementById('cart-count').textContent = cartCount;
  renderCart();
  renderSubscriptions();
  showToast('Merci pour votre achat ! (simulé)');
}

function addSubscription(btnOrName, subName, price){
  // Support calling addSubscription(this,'Basic',10) or addSubscription('Basic',10)
  let name = subName;
  if (typeof btnOrName === 'string') name = btnOrName;
  // if first arg is element, use provided subName param
  const sName = name || subName;
  subscriptions.push({ name: sName, price: price || 0, date: new Date().toISOString() });
  try { localStorage.setItem('bhw_subscriptions', JSON.stringify(subscriptions)); } catch(e){ console.warn('localStorage', e); }
  renderSubscriptions();
  showToast("Abonnement '"+sName+"' ajouté à votre profil");
}

function renderSubscriptions(){
  const el = document.getElementById('subscriptions-list');
  if(!el) return;
  el.innerHTML = '';
  if(!subscriptions || subscriptions.length === 0){ el.innerHTML = '<li>Aucun abonnement</li>'; return; }
  subscriptions.forEach((s, idx)=>{
    const li = document.createElement('li');
    li.innerHTML = `${s.name} (${new Date(s.date).toLocaleDateString()}) <button onclick="removeSubscription(${idx})" style="margin-left:8px;background:transparent;border:none;color:#d00;cursor:pointer">Suppr</button>`;
    el.appendChild(li);
  });
}

function removeSubscription(index){
  if(!subscriptions || index < 0 || index >= subscriptions.length) return;
  subscriptions.splice(index,1);
  try{ localStorage.setItem('bhw_subscriptions', JSON.stringify(subscriptions)); } catch(e){}
  renderSubscriptions();
  showToast('Abonnement supprimé');
}

// small toast implementation
function showToast(message){
  let t = document.getElementById('bhw-toast');
  if (!t){
    t = document.createElement('div');
    t.id = 'bhw-toast';
    t.style.position = 'fixed';
    t.style.right = '20px';
    t.style.bottom = '90px';
    t.style.background = 'rgba(0,0,0,0.75)';
    t.style.color = '#fff';
    t.style.padding = '10px 14px';
    t.style.borderRadius = '10px';
    t.style.zIndex = 9999;
    t.style.fontSize = '14px';
    document.body.appendChild(t);
  }
  t.textContent = message;
  t.style.opacity = '1';
  clearTimeout(t._timeout);
  t._timeout = setTimeout(()=>{ t.style.transition = 'opacity .4s ease'; t.style.opacity='0'; }, 1800);
}
function showSection(id){
  // Affiche la section demandée (single-page behavior)
  document.querySelectorAll('main section').forEach(sec => sec.classList.remove('active'));
  const target = document.getElementById(id);
  if(target) target.classList.add('active');

  // Met à jour l'état actif du menu
  document.querySelectorAll('.bottom-nav .nav-item').forEach(item => {
    const isActive = item.dataset && item.dataset.target === id;
    item.classList.toggle('active', isActive);
  });

  // Ferme le panneau "Plus" si ouvert
  const more = document.getElementById('more-modal');
  if(more && more.classList.contains('open')){ more.classList.remove('open'); more.setAttribute('aria-hidden','true'); }
}

function toggleMore(){
  const more = document.getElementById('more-modal');
  if(!more) return;
  const wasOpen = more.classList.contains('open');
  if (wasOpen) {
    // Closing the modal: ensure no element inside remains focused (accessibility)
    const active = document.activeElement;
    if (more.contains(active)) {
      // move focus back to the FAB or to main content
      const fab = document.querySelector('.fab-more');
      if (fab) fab.focus();
      else if (document.getElementById('home')) document.getElementById('home').focus();
      else document.body.focus && document.body.focus();
    }

    more.classList.remove('open');
    more.setAttribute('aria-hidden','true');
    // Prefer using inert where supported to prevent focus; otherwise rely on aria-hidden
    try { more.inert = true; } catch(e) { /* inert may not be supported */ }
  } else {
    // Opening the modal
    more.classList.add('open');
    more.setAttribute('aria-hidden','false');
    try { more.inert = false; } catch(e) { }
    // Move focus to the first focusable element inside the modal for keyboard users
    const firstFocusable = more.querySelector('a, button, input, [tabindex]:not([tabindex="-1"])');
    if (firstFocusable) firstFocusable.focus();
  }
}

// Initialize active nav on load
document.addEventListener('DOMContentLoaded', () => {
  showSection('home');
});
  // Enregistrement du service worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js')
      .then(() => console.log("✅ Service Worker enregistré"))
      .catch(err => console.error("❌ Erreur SW:", err));
  }
</script>

</body>
</html>